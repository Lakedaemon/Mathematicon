\catcode`@=11\relax
\input LD@Header.tex
\input LD@Library.tex
\input LD@Typesetting.tex
\input LD@Exercices.tex
\input LD@Inferno@Macros.tex

\def\imageFolder{/media/Main/TeX/Mathematicon}
\ifHtml
	\input LD@Html
	\tikzstyle{every picture}=[svg text only=false,svg text css=Mathematicon]%
	\font\LD@Font@Tiny=cmr10\relax
	\font\LD@Font@Inferno=cmr10\relax
	\font\LD@Font@Arial=cmr10\relax
	\font\LD@Font@Gothic=cmr10\relax
	\font\LD@Font@Sanctuary=cmr10\relax
\else
	\LD@AFour@Book
	\catcode`@=11\relax
	\let\LD@Font@Tiny\fiverm\relax
	\font\LD@Font@Inferno="Riot Act 2" at 12pt\relax
	\font\LD@Font@Arial="Nimbus Sans L" at 10pt\relax
	\font\LD@Font@Gothic="Metal Macabre"\relax
	\font\LD@Font@Sanctuary="Sanctuary"\relax
\fi
\tenrm




%\long\def\Chapter #1, #2.{\init{\titredeux}\ifSecLabelEq\init{\eqnumber}\fi\ifHtml\writetocentry{chapter}{#2}\EndP\ifCenteredchapter\HCode{<div class="centerline">}\else\HCode{<div class="flushleft">}\fi
%\HCode{<span class="chapter">}{\fontetitreun\incr{\titreun}.\ \fontetitreun #2}\HCode{</span></div>}\PAR\else 
%\removelastskip\par\bigskip\bigskip\goodbreak\vskip0pt plus.01\vsize\penalty-200\vskip0pt plus-.01\vsize        
 %                                     \bigbreak\noindent\writetocentry{chapter}{#2}{\ifCenteredchapter\parindent0mm\raggedcenter\fi\fontetitreun\incr{\titreun}.\ \fontetitreun #2\par}\nobreak
%                                       \medskip\definexref{chap#1}{\the\titreun}{}%\definexref{#1}{#2}{}\definexref{ǧ§#1}{\the\pageno}{}% fix this
%\fi}


\overfullrule=0pt%
\nopagenumber
\newdimen\LD@dimena\LD@dimena=18cm\relax\advance\LD@dimena by-1cm\relax
\newdimen\LD@dimenb\LD@dimenb=28cm\relax\advance\LD@dimenb by-4cm\relax
 %
\centerline{%
	%\unless\ifHtml\font\SvgText=Papyrus\relax\fi
	\tikzpicture
	\ifHtml 
		\node[text height=2\LD@dimenb,text width=2\LD@dimenb,tex4ht node/escape=true] (a) {\noindent\smash{\Image[Height=2\LD@dimenb,Width=2\LD@dimenb]{\imageFolder/Abime.jpg}}}%
	\else
		\ifLD@Inferno@Master@
			\node[text width=\LD@dimena,text height=\LD@dimenb%,draw,line width=2pt,inner sep=0pt
	] (a) at (0,-2) {\noindent\smash{\Image[Width=\LD@dimena,Height=\LD@dimenb]{\imageFolder/AbimMaster.jpg}}}%
		\else
			\node[text width=\LD@dimena,text height=\LD@dimenb%,draw,line width=2pt,inner sep=0pt
	] (a) at (0,-2) {\noindent\smash{\Image[Width=\LD@dimena,Height=\LD@dimenb]{\imageFolder/Abime.jpg}}}%
		\fi
	\fi
node [below=0.7cm,inner sep=1pt] (b) at (a.north) {};
\node [inner sep=1.5pt,above=2.1cm] (c) at (a.south) {};
\node [inner sep=1pt,below=1.35cm] (d) at (c) {};
\foreach\angle in {0,15,...,360}
{%
\node[color=black,scale=1.5] at (b.\angle) {\LD@Font@Gothic Olus Livius Bindus};
\node[color=black,scale=6] at (c.\angle) {\LD@Font@Inferno Inferno}; 
\node[color=black,scale=1.5] at  (d.\angle)  {\LD@Font@Sanctuary Abandon hope, all ye who enter here...};
}%
\node[color=gray,scale=1.5] at (b) {\LD@Font@Gothic Olus Livius Bindus};
\node[color=gray,scale=6] at (c) {\LD@Font@Inferno Inferno};
\node[color=gray, scale=1.5] at (d) {\LD@Font@Sanctuary  Abandon hope, all ye who enter here...};
\endtikzpicture}%
\headline={\ifpagetitre\the\hautpagetitre
\else\ifodd\pageno\the\hautpagedroite\else\the\hautpagegauche\fi\fi }
\footline={\ifpagetitre\the\baspagetitre
\else\ifodd\pageno\the\baspagedroite
\else\the\baspagegauche\fi\fi \global\pagetitrefalse}
\hautpagegauche={\ifMidFolio\the\hautpagemilieu\else\tenrm\folio\hfil\the\auteurcourant\hfil\fi}
\hautpagedroite={\ifMidFolio\the\hautpagemilieu\else\hfil\the\titrecourant\hfil\tenrm\folio\fi}
\eject
\def\pgfutil@EveryShipout@Output{%
  \setbox255=\vbox{%
    \setbox0=\hbox{\pgfutil@abe\pgfutil@abc\global\let\pgfutil@abc\pgfutil@empty}%
    \wd0=0pt%
    \ht0=0pt%
    \dp0=0pt%
    \box0%
    \makeheadline
    \unvbox255%
    \makefootline
  }%
  \pgfutil@@EveryShipout@Org@Shipout\box\@cclv%
}
\hautspages{}{}%
\catcode`@=11\relax
\def\LD@AFour@Book{%
\hsize170truemm\vsize 250truemm\hoffset=-5truemm\voffset=-13truemm
\pretolerance=500\relax
\tolerance=1000\relax
\brokenpenalty=5000\relax
\parindent3mm
\paperwidth=210truemm
\paperheight=297truemm
\pdfpagewidth=210truemm
\pdfpageheight=297truemm
}
\LD@AFour@Book
\centerline{\seventeenbf Table des Matières}
\bigskip
\readtocfile

\eject
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\formatpage

\Chapter sol, Légende.

L'entête de chaque exercise précise le niveau \tikz\node[fill=green!30,inner sep=1pt,baseline]{$n$};, la difficulté \tikz\node[fill=red!30,inner sep=1pt,baseline]{$d$};, la richesse pédagogique \tikz\node[fill=blue!30,inner sep=1pt,baseline]{$r$}; (i.e. le nombre de nouveaux concepts, d'idées intéressantes contenues qu'enseigne la résolution de l'exercice) et parfois  également la provenance  \tikz\node[fill=purple!30,inner sep=0pt,baseline]{$o$}; de l'exercice. 
\medskip

Il est également indiqué si l'exercice est associé {\it à des indications}, $\underline{\hbox{à des concepts utiles à sa résolution}}$ ou {\bf à une solution}, \unless\ifLD@Inferno@Master@
que vous trouverez respectivement aux sections \refn{chapIndications}, \refn{chapNotions} et \refn{chapSolutions}, \fi
selon le schema suivant : 
$$
\tikzpicture
	\node[fill=yellow!30] (exo) at (0,0) {Exercice};
	\node[below=0pt of exo.north east,inner sep=0.5pt,fill=green!30] (n) {$\scriptstyle n$};
	\node[above=1pt of exo.west,fill=red!30,inner sep=0.5pt] (d) {$\scriptstyle d$};
	\node[below=1pt of exo.west,fill=blue!30,inner sep=0.5pt] (r) {$\scriptstyle r$};
	\node[left=0.15cm of exo.west,fill=purple!30,inner sep=1pt] (o) {$\scriptstyle (o)$};
	\node[below right=-0.7cm and 0.7cm of n,matrix of nodes,fill=green!30,draw,font=\LD@Font@Tiny] (niveau) {%
%		\flat\flat& Lycée,\cr
		$\scriptscriptstyle n$ &Année\\
		$\scriptscriptstyle\flat$&Math. Sup. (L1)\\
		&Math. Spé. (L2) \\
%		$\scriptscriptstyle\sharp$&Licence (L3)\\
%		\sharp\sharp&Maitrise (M1),\cr
%		\sharp\sharp\sharp&DEA/DESS (M2).\cr
	};
	\node[above right=0.8cm and -3.85cm of d,matrix of nodes,fill=red!30,draw,font=\LD@Font@Tiny] (difficulte) {%
		$\scriptscriptstyle d$&Type&PT&PT*/MP&MP*\\
% 		-1&évident&Trop facile&Perte de temps&Bah\\
		&appliquer le cours&Facile&Trop facile&Perte de temps\\
		1&adapter le cours&Facile/Moyen&Facile&Trop facile\\
		2&ENSAM/CCP&Moyen/dur&Facile/Moyen&Facile\\
		3&Centrale/Mines&Dur/Baleze&Moyen/dur&Facile/Moyen\\
		4&Polytechnique&Baleze/Infernal&Dur/Baleze&Moyen/dur\\
		5&Ens Ulm&Infernal/Impossible&Baleze/Infernal&Dur/Baleze\\
	};
	\node [fill=purple!30,draw,font=\LD@Font@Tiny] (origin) at (-3.4,0) {origine de l'exercice};
	\node[below left=0.8cm and -0.7cm of r,matrix of nodes,fill=blue!20,draw,font=\LD@Font@Tiny] (richesse) {%
% 		-1&Perte de temps&\\	
		$\scriptscriptstyle r$&Type&Contenu\\
		&Entrainement&0 idée nouvelle\\
		1&Formateur&1+ idée nouvelle\\
		2&Classique&2+ idées nouvelles\\
		3&Culte&3+ idées nouvelles\\
	};
	\node[below right=0.7cm and -0.5cm of exo,matrix of nodes,fill=yellow!30,draw,font=\LD@Font@Tiny] (metadata) {%
		typographie&Contenu\\
		Exercice&énoncé\\
		{\sixit Exercice}& avec indication(s)\\
		{\fivebf Exercice}& avec solution\\
		$\underline{\mbox{Exercice}}$& avec notions utiles\\
	};
	\draw[->] (o) -- (origin);
	\draw[->] (d) -- (difficulte);
	\draw[->] (r) -- (richesse);
	\draw[->] (n) -- (niveau);
	\draw[->] (exo) -- (metadata);
\endtikzpicture
$$
\vfil
\eject

\LD@Exo@Theme@Display{1,2}\LD@Exo@Theme@List{%
	\Cours,\TravauxDirigés,\Exercices,\Colles%,\Problèmes,\Others,\Mathematica,\Maple,\LD@Empty
}%
\unless\ifLD@Inferno@Master@
	\eject
	\Chapter Indications, Indications.

	\LD@Exo@Indication@Display

	\Chapter Notions, Notions.

	\LD@Exo@Notion@Display

	\Chapter Solutions, Solutions.

	\LD@Exo@Sol@Display
\fi
\LD@dimenb=1cm\relax
\bye
	\LD@Loop@For\LD@Level=1,2\WithSeparator ,\Do{%
	\centerline{\seventeenbf \LD@Display\LD@Level}%
	\bigskip
	%\EA\let\EA\LD@List\CS LD@Exo@Theme@@\LD@Level\EC
	{
		\LD@Exo@Theme@Display\LD@Level\LD@Exo@Theme@List{\Cours,\TravauxDirigés,\Exercices,\Colles,\Problèmes,\Others,\Mathematica,\Maple,\LD@Empty}%
	}%
}%
\medskip\noindent
\the\LD@Exo@Total\LD@Space Exercices
\bye